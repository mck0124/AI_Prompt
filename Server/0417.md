# ğŸ“˜ Spring MVC

---

## âš ï¸ Eclipse ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ í•´ê²° íŒ

- ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ:
    
    `C:/Users/ì‚¬ìš©ì/.m2/repository`Â ë””ë ‰í† ë¦¬ ë‚´ ëª¨ë“  íŒŒì¼ ì‚­ì œ â†’ í”„ë¡œì íŠ¸ Clean & Build ìˆ˜í–‰
    

---

# âœ… Spring MVC ì „ì²´ êµ¬ì¡° ë° íë¦„

## ğŸŒ ìš”ì²­ íë¦„ ìš”ì•½

| ë‹¨ê³„ | ì„¤ëª… |
| --- | --- |
| 1 | í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´Â `DispatcherServlet`ìœ¼ë¡œ ì „ë‹¬ë¨ |
| 2 | `HandlerMapping`ì´ ì–´ë–¤ Controllerê°€ ì²˜ë¦¬í• ì§€ ê²°ì • |
| 3 | í•´ë‹¹Â `Controller`ê°€ ìš”ì²­ ì²˜ë¦¬ |
| 4 | ì²˜ë¦¬ ê²°ê³¼ë¥¼Â `ModelAndView`Â ê°ì²´ë¡œ ë°˜í™˜ |
| 5 | `ViewResolver`ê°€ ì–´ë–¤ Viewë¡œ ë³´ë‚¼ì§€ ê²°ì • |
| 6 | View(JSP ë“±)ê°€ ë Œë”ë§ë˜ì–´ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µ ì „ì†¡ |

## ğŸ§¾ DispatcherServlet ì„¤ì •

```xml
<context:component-scan base-package="org.zerock.controller"/>

```

- ì§€ì •ëœ íŒ¨í‚¤ì§€(`org.zerock.controller`)ì˜ í´ë˜ìŠ¤ë¥¼ ìŠ¤ìº”í•˜ì—¬ Beanìœ¼ë¡œ ìë™ ë“±ë¡
- `@Controller`,Â `@Service`,Â `@Repository`,Â `@Component`Â ë“±ì˜ ì–´ë…¸í…Œì´ì…˜ ì¸ì‹

---

# âœ… ê¸°ë³¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì˜ˆì œ (`HomeController`)

## ğŸ“„Â `HomeController.java`

```java
@Controller
public class HomeController {

    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String home(Locale locale, Model model) {
        Date date = new Date();
        DateFormat dateFormat = DateFormat.getDateTimeInstance(
            DateFormat.LONG, DateFormat.LONG, locale);

        String formattedDate = dateFormat.format(date);
        model.addAttribute("serverTime", formattedDate);

        return "home"; // â†’ home.jsp
    }
}

```

## ğŸ“Œ ì„¤ëª… ìš”ì•½

| ìš”ì†Œ | ì„¤ëª… |
| --- | --- |
| `@Controller` | í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì»¨íŠ¸ë¡¤ëŸ¬ì„ì„ ì§€ì • |
| `@RequestMapping` | íŠ¹ì • URLì— ëŒ€í•œ ìš”ì²­ ì²˜ë¦¬ ì§€ì • |
| `Locale` | í´ë¼ì´ì–¸íŠ¸ì˜ ì–¸ì–´ ì„¤ì • ì •ë³´ (ìë™ ì£¼ì…) |
| `Model` | Viewë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ë•Œ ì‚¬ìš© |
| `return "home"` | ViewResolverë¥¼ í†µí•´Â `/WEB-INF/views/home.jsp`Â ë°˜í™˜ |

---

# âœ… ViewResolver ì„¤ì •

```xml
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/"/>
    <property name="suffix" value=".jsp"/>
</bean>

```

- `return "home"`Â â†’Â `/WEB-INF/views/home.jsp`ë¡œ ì—°ê²°ë¨

---

# âœ… ì˜ˆì œ: HelloController + hello.jsp

## ğŸ“„Â `HelloController.java`

```java
@Controller
public class HelloController {

    @GetMapping("/hello")
    public String hello(Model model) {
        model.addAttribute("message", "Hello Spring");
        return "hello";
    }
}

```

## ğŸ“„Â `hello.jsp`

```
<body>
    ê²°ê³¼ë‚´ìš©: <b>${message}</b>
</body>

```

---

# âœ… ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ ì—°ë™ ì˜ˆì œ

## ğŸ“„Â `HelloService.java`

```java
@Service
public class HelloService {
    public String getMessage() {
        return "ë§›ì  í•˜ì„¸ìš”.";
    }
}

```

## ğŸ“„Â `HelloController.java`

```java
@Controller
public class HelloController {

    @Autowired
    private HelloService service;

    @GetMapping("/hello")
    public String hello(Model model) {
        model.addAttribute("message", service.getMessage());
        return "hello";
    }
}

```

## ğŸ“„Â `root-context.xml`

```xml
<context:component-scan base-package="org.zerock.service"/>

```

---

## ğŸ“ŒÂ `@Autowired`

### âœ”ï¸ ê°œë… ìš”ì•½

`@Autowired`ëŠ” Spring Frameworkì—ì„œÂ **ì˜ì¡´ì„± ì£¼ì…(Dependency Injection)**Â ì„ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•´ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤. ê°ì²´ë¥¼ ê°œë°œìê°€ ìˆ˜ë™ìœ¼ë¡œ ìƒì„±í•˜ì§€ ì•Šê³ , ìŠ¤í”„ë§ì´ ì•Œì•„ì„œ í•´ë‹¹ íƒ€ì…ì˜ ê°ì²´ë¥¼ ì°¾ì•„ ì£¼ì…í•´ì¤€ë‹¤.

### âœ”ï¸ ìƒì„¸ ì„¤ëª…

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| ì •ì˜ | ìŠ¤í”„ë§ì—ì„œ ì˜ì¡´ì„± ì£¼ì…ì„ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ |
| ëŒ€ìƒ | ìƒì„±ì, í•„ë“œ, ì„¸í„° ë©”ì„œë“œ ë“±ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŒ |
| ë™ì‘ | ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” Bean ì¤‘ íƒ€ì…ì´ ì¼ì¹˜í•˜ëŠ” ê°ì²´ë¥¼ ìë™ ì£¼ì…í•¨ |
| ì¡°ê±´ | í•´ë‹¹ ê°ì²´ê°€Â `@Component`,Â `@Service`Â ë“±ìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•¨ (`@ComponentScan`Â í•„ìš”) |

### âœ”ï¸ ì‚¬ìš© ì˜ˆì‹œ

```
@Autowired
private HelloService service; // ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ HelloService íƒ€ì… Bean ì£¼ì…
```

### âœ”ï¸ ì£¼ì˜ì‚¬í•­

- Beanìœ¼ë¡œ ë“±ë¡ë˜ì§€ ì•Šì€ í´ë˜ìŠ¤ì—ëŠ” ì£¼ì…í•  ìˆ˜ ì—†ìœ¼ë©°,Â `NoSuchBeanDefinitionException`Â ë°œìƒ
- ìƒì„±ì ì£¼ì… ì‹œ, Spring 4.3 ì´ìƒì—ì„œëŠ”Â `@Autowired`Â ìƒëµ ê°€ëŠ¥

## ğŸ“ŒÂ `model.addAttribute()`ë€?

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| ì •ì˜ | Controllerê°€ Viewë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œ (Model ê°ì²´ì— ê°’ ì €ì¥) |
| í˜•íƒœ | `model.addAttribute("í‚¤", ê°’);`Â â†’ Viewì—ì„œëŠ”Â `${í‚¤}`ë¡œ ì ‘ê·¼ ê°€ëŠ¥ |
| ìœ„ì¹˜ | ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œ ë‚´ì—ì„œ ì‚¬ìš© |

### ì˜ˆ:

```
@GetMapping("/hello")
public String hello(Model model) {
    model.addAttribute("message", "Hello Spring");
    return "hello";
}
```

### íŠ¹ì§•:

- request scopeì— ë°ì´í„°ê°€ ì €ì¥ë¨
- ë·°(JSP, Thymeleaf ë“±)ì—ì„œ EL(Expression Language)ë¡œ ì¶œë ¥ ê°€ëŠ¥ (`${message}`)
- -----|------| | ì •ì˜ | ìŠ¤í”„ë§ì—ì„œÂ **ì˜ì¡´ì„± ì£¼ì…(Dependency Injection)**Â ì„ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ | | ëŒ€ìƒ | ìƒì„±ì, í•„ë“œ, ë©”ì„œë“œì— ë¶™ì¼ ìˆ˜ ìˆìŒ | | ë™ì‘ | ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” Beanì„ ìë™ìœ¼ë¡œ ì°¾ì•„ ì£¼ì…í•¨ | | ì¡°ê±´ |Â `@ComponentScan`ì— ì˜í•´ í•´ë‹¹ í´ë˜ìŠ¤ê°€ Beanìœ¼ë¡œ ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•¨ |

### ì˜ˆ:

```
@Autowired
private HelloService service; // ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ HelloService íƒ€ì…ì„ ì°¾ì•„ì„œ ì£¼ì…
```

### ì£¼ì˜:

- ì£¼ì… ëŒ€ìƒì´ Beanìœ¼ë¡œ ë“±ë¡ë˜ì§€ ì•Šìœ¼ë©´ ì˜ˆì™¸ ë°œìƒ (`NoSuchBeanDefinitionException`)
- ìƒì„±ìì— ì‚¬ìš©í•˜ë©´Â `@Autowired`Â ìƒëµ ê°€ëŠ¥ (Spring 4.3+)

---

# âœ… ì˜ì¡´ì„± ì£¼ì… í…ŒìŠ¤íŠ¸ ì˜ˆì œ (Restaurant, Chef)

## ğŸ“„Â `Chef.java`

```java
@Component
@Data
public class Chef {
    private String name;
}

```

## ğŸ“„Â `Restaurant.java`

```java
@Component
@Data
@AllArgsConstructor
@NoArgsConstructor
public class Restaurant {

    @Autowired
    private Chef chef;
}

```

## ğŸ“„Â `SampleTests.java`

```java
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("file:src/main/webapp/WEB-INF/spring/root-context.xml")
@Log4j
public class SampleTests {

    @Autowired
    private Restaurant restaurant;

    @Test
    public void test() {
        assertNotNull(restaurant);
        log.info(restaurant);
        log.info(restaurant.getChef());
    }
}

```

---

# âœ… SampleController ì£¼ìš” ê¸°ëŠ¥ ì •ë¦¬

## ğŸ“„ ê¸°ë³¸ êµ¬ì¡°

```java
@Controller
@Log4j
@RequestMapping("/sample/*")
public class SampleController {
    ...
}

```

---

## ğŸ“Œ ê¸°ëŠ¥ë³„ ë©”ì„œë“œ ì •ë¦¬

### ğŸ”¹Â `/sample/basic`

```java
@GetMapping("basic")
public void basicGet() {
    log.info("basic...........");
}

```

- View ì´ë¦„ì€Â `basic.jsp`

### ğŸ”¹Â `/sample/ex01?name=í™ê¸¸ë™&age=20`

```java
@GetMapping("ex01")
public String ex01(SampleDTO dto)

```

- íŒŒë¼ë¯¸í„° ìë™ ë°”ì¸ë”© (DTO)
- View:Â `ex01.jsp`

### ğŸ”¹Â `/sample/ex02?name=í™ê¸¸ë™&age=20`

```java
@GetMapping("ex02")
public String ex02(@RequestParam("name") String name,
                   @RequestParam("age") int age)

```

- íŒŒë¼ë¯¸í„° ìˆ˜ë™ ë°”ì¸ë”©

### ğŸ”¹Â `/sample/ex03`Â â†’ Redirect toÂ `/sample/ex04`

```java
@GetMapping("ex03")
public String ex03(RedirectAttributes rttr)

```

- `rttr.addAttribute()`Â â†’ URL íŒŒë¼ë¯¸í„° ì „ë‹¬

### ğŸ”¹Â `/sample/ex04?name=bbb&age=30&page=1`

```java
@GetMapping("ex04")
public String ex04(SampleDTO dto, @ModelAttribute("page") int page)

```

- DTO + ê°œë³„ íŒŒë¼ë¯¸í„° í•¨ê»˜ ì²˜ë¦¬

---

# âœ…Â `@ResponseBody`Â ì‚¬ìš© ì˜ˆì œ (`/sample/ex05`)

## ğŸ“„ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œ

```java
@GetMapping("ex05")
public @ResponseBody SampleDTO ex05() {
    SampleDTO dto = new SampleDTO();
    dto.setName("í™ê¸¸ë™");
    dto.setAge(20);
    return dto;
}

```

## ğŸ“Œ ì„¤ëª…

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| `@ResponseBody` | View ë°˜í™˜ì´ ì•„ë‹Œ JSON ë“± ì‘ë‹µ ë³¸ë¬¸ì— ë°ì´í„° ì „ì†¡ |
| ë°˜í™˜ íƒ€ì… | `SampleDTO`Â ê°ì²´ â†’ JSON ìë™ ë³€í™˜ (jackson ì‚¬ìš©) |

## ğŸ”¸ ì‘ë‹µ ì˜ˆì‹œ (JSON)

```json
{
  "name": "í™ê¸¸ë™",
  "age": 20
}

```

## ğŸ“„ ëŒ€ì²´ ì˜ˆì‹œ:Â `@RestController`

```java
@RestController
@RequestMapping("/sample")
public class SampleRestController {
    @GetMapping("/ex05")
    public SampleDTO ex05() {
        return new SampleDTO("í™ê¸¸ë™", 20);
    }
}

```

---

# âœ… ì •ë¦¬ ìš”ì•½

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| `@Controller` | Spring MVC ì»¨íŠ¸ë¡¤ëŸ¬ ë“±ë¡ |
| `@Service` | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬ í´ë˜ìŠ¤ ë“±ë¡ |
| `@Autowired` | ìŠ¤í”„ë§ ë¹ˆ ìë™ ì£¼ì… (DI) |
| `Model` | ë·°ë¡œ ë°ì´í„° ì „ë‹¬ |
| `ViewResolver` | ë·° ê²½ë¡œ ìë™ ë§¤í•‘ (/WEB-INF/views/...) |
| `@ResponseBody` | ê°ì²´ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•´ HTTP ì‘ë‹µìœ¼ë¡œ ì „ì†¡ |
| `RedirectAttributes` | ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œ íŒŒë¼ë¯¸í„° ì „ë‹¬ |
